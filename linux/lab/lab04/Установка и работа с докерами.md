**Задание: Установить docker**

apt install docker.io

# Проверяем что сервис докера запущен

systemctl status docke.service 

![](image.png)

# Проверяем что установка прошла успешно

docker run hello-world

![alt text](image-1.png)

# Команда run стартует контейнер, она его скачивает при отсутствии и запускает


# Локально он его найти не смог и пошел качать с репозитория докер
# хеш контейнера: 

sha256:5b3cc85e16e3058003c13b7821318369dad01dac3dbb877aac3c28182255c724

# Команда вывода списка текущих запущенных контейнеров

docker ps

# Команда с флагом -a показывает все, даже запущенные ранее и остановленные

docker ps -a

![alt text](image-3.png)


# Для правильной работы нужно чтобы пользоватлеть имел права рута или добавлен в группу docker

![alt text](image-2.png)

# Команда для добавления пользователя в группу докер

usermod -aG docker Sentsov

# Базовые команды докера:

#  Информация о версии, количество запущенных контейнеров, образов и т.п

docker info

# Скачать контейнер например ubuntu 20.04

docker pull ubuntu:20.04

# Удалить образ контейнера (просто rm - удалить контейнер, контейнеры можно удалять по имени или по их ID)

docker rmi ubuntu:20.04

# Посмотреть список образов

docker images

![alt text](image-4.png)

# Запускаем Баш внутри контейнера nginx2

docker exec -it nginx2 bash  

(Скорее всего баша в контейнере nginx нет, но тогда можно попробовать запустить sh)

# После того как зашли в контейнер, можно посмотреть список утилит docker exec -it nginx2 sh 
# ls /usr/bin   - скорее всего список утилит будет отличаться от тех что установлены на вашем хосте (компьютере)

# Перезапускаем контейнер nginx

docker restart nginx

# Существует три вида работы с контейнерами по сети: 1.бридж с пробром портов, что мы будем использовать в примере далее, 2. отключение сети 3. Управление с хоста

docker network ls

![alt text](image-8.png)

наиболее частым будет использование с пробросом портов, вариант с хостом вообще не рекомендуется

**Задание: найти образ nginx и скачать его**

# Команда поиска nginx

docker search nginx

![alt text](image-5.png)

# Качаем официальный образ с пометкой official

docker pull nginx

# По умолчанию скачается последняя версия :lates, если нужна определенная версия, заходим на оф сайт https://hub.docker.com ищем официальный контейнер производителя и смотрим какую версию можно скачать например docker pull nginx:1.27.3-alpine




**Задание: запустить контейнер nginx на базе образа nginx**

docker run -d --name nginx1 -p 8081:80 nginx:1.27.3-alpine  
#команда запускает наш контейнер с именем nginx1 на порту 8081:80 (порт 8081 на хостовой машине, а порт 80 тот что внутри нашего контейнера = весь трафик с хоста 192.168.106.167:8081 перебрасываем на 80 порт контейнера)

# проверяем

curl 192.168.106.167:8081

![alt text](image-6.png)

![alt text](image-7.png)

# Запустить одновременно несколько контейнеров с разными именами (nginx1, nginx2 и т.п) на одном порту нельзя, нужно добавлять каждое имя на свой порт 8082, 8083 и т.п

**Задание: подключить конфигурационные файлы nginx из ДЗ с web-сервером в контейнер nginx**

docker run -d --name nginx2 -p 8082:80 -v /home/master/nginx/html:/usr/share/nginx/html nginx:1.27.3-alpine

# Ключ -v задает параметры /home/master/nginx/html - наш хост, откуда берем информацию (в нашем варианте файл html) /usr/share/nginx/html - путь в контейнере куда мы ее хотим направить)

**Задание: в контейнер nginx пробросить файлы конфигурации nginx с хоста**

# Скопируем конфигурационный файл контейнера nginx1 на свой компьютер, для дальнейшего редактирования и возврата обратно в контейнер в измененном виде

docker cp nginx1:/etx/nginx /home/master/ngingx/etc/

nano nginx.conf

# Останавливаем контейнер

docker stop nginx1

docker run -d --name nginx1 -p 8081:80 -v /home/master/nginx/etc:/etc/nginx nginx:1.27.3-alpine

===================================================================
# Задание для себя (создать собственный образ на основе nginx)

# Для этого нужно создать докер файл (обязательно с заглавной буквы)

touch Testdocker  #(/home/master/)

nano Testdocker

# Внутри пишем следующее (пояснение: с какого образа мы берем основание FROM nginx.latest с докерхаб.ком и меняем ему индекс файл, команда отработает из текущей дериктории ./index.html, поэтому предварительно нужно положить файл html в каталог где мы работаем /home/master/ )

FROM nginx.latest
COPY ./index.html /usr/share/nginx/html/index.html

ctrl+x 

yes 

enter

# Теперь собираем свой образ находясь в нужной дериктории, предварительно подготовленной

docker build -t nginx-test .

# Точка означает текущую директорию, -t ключ для задания имяни нашему образу

