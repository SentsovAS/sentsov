# **Лабораторная работа. Развертывание коммутируемой сети с резервными каналами**


![alt text](image.png)
!


# **Часть 1:	Создание сети и настройка основных параметров устройства**

!

# **Шаг 1:	Создайте сеть согласно топологии.**

!

**Шаг 2:	Выполните инициализацию и перезагрузку коммутаторов.**

!

**Шаг 3:	Настройте базовые параметры каждого коммутатора.**

!

a.	Отключите поиск DNS.

b.	Присвойте имена устройствам в соответствии с топологией.

c.	Назначьте class в качестве зашифрованного пароля доступа к 
привилегированному режиму.

d.	Назначьте cisco в качестве паролей консоли и VTY и активируйте вход для 
консоли и VTY каналов.

e.	Настройте logging synchronous для консольного канала.

f.	Настройте баннерное сообщение дня (MOTD) для предупреждения 
пользователей о запрете несанкционированного доступа.

g.	Задайте IP-адрес, указанный в таблице адресации для VLAN 1 на всех 
коммутаторах.

h.	Скопируйте текущую конфигурацию в файл загрузочной конфигурации.

!


Настройки коммутатора №1

!

Enable

Conf t

Hostname S1

no ip domain-lookup

Line console 0

Password cisco 

Login

exit

Service password-encryption

Enable secret class

Banner motd =warning=

Line vty 0 4

password cisco

logging synchronous

Exit

Int vlan 1

Ip add 192.168.1.1 255.255.255.0

No shutdown

Exit

exit

Copy run start

Настройка коммутатора № 2

Enable

Conf t

Hostname S2

no ip domain-lookup

Line console 0

Password cisco 

Login

exit

Service password-encryption

Enable secret class

Banner motd =warning=

Line vty 0 4

password cisco

logging synchronous

Exit

Int vlan 1

Ip add 192.168.1.2 255.255.255.0

No shutdown

Exit

exit

Copy run start

!

Настройка коммутатора № 3

Enable

Conf t

Hostname S3

no ip domain-lookup

Line console 0

Password cisco 

Login

exit

Service password-encryption

Enable secret class

Banner motd =warning=

Line vty 0 4

password cisco

logging synchronous

Exit

Int vlan 1

Ip add 192.168.1.3 255.255.255.0

No shutdown

Exit

exit

Copy run start



**Шаг 4:	Проверьте связь.**



!

Проверьте способность компьютеров обмениваться эхо-запросами.

Успешно ли выполняется эхо-запрос от коммутатора S1 на коммутатор S2?

Успешно ли выполняется эхо-запрос от коммутатора S1 на коммутатор S3?

Успешно ли выполняется эхо-запрос от коммутатора S2 на коммутатор S3?

Выполняйте отладку до тех пор, пока ответы на все вопросы не будут 
положительными.

!

![alt text](image-1.png)

!

![alt text](image-2.png)

!

**Часть 2:	Определение корневого моста**

!

**Шаг 1:	Отключите все порты на коммутаторах.**

**Шаг 2:	Настройте подключенные порты в качестве транковых.**

**Шаг 3:	Включите порты F0/2 и F0/4 на всех коммутаторах.**

**Шаг 4:	Отобразите данные протокола spanning-tree.**

Коммутатор № 1,2,3

Enable

Conf t

Int range e0/0-3

Shutdown

Exit

Int range e0/0-3

no switchport trunk encapsulation auto

switchport trunk encapsulation dot1q

switchport mode trunk

Int range e0/1, e0/3

no shutdown

do show spanning-tree

![alt text](image-3.png)



**С учетом выходных данных, поступающих с коммутаторов, ответьте на следующие вопросы**

!

**Какой коммутатор является корневым мостом?**

Корневым мостом является коммутатор S1

**Почему этот коммутатор был выбран протоколом spanning-tree в качестве корневого моста?**

При равных приоритетах (как в нашем случаи) коммутатор с самым низким значением MAC-адреса становится корневым мостом.

**Какие порты на коммутаторе являются корневыми портами?**

Порт коммутатора, который имеет кратчайший путь к корневому коммутатору называется корневым портом

**Какие порты на коммутаторе являются назначенными портами?**

Назначенными портами (Desg) являются порты коммутатора имеющие наименьшее расстояние до корневого коммутатора

**Какой порт отображается в качестве альтернативного и в настоящее время заблокирован?**

e0/3 на коммутаторе S2 отображается в качестве альтернативного и в настоящее время заблокирован

**Почему протокол spanning-tree выбрал этот порт в качестве невыделенного (заблокированного) порта?**

spanning-tree (STA) использует корневой мост как точку привязки, после чего определяет, какие порты будут заблокированы, исходя из стоимости пути

!

**Шаг 2:	Измените стоимость порта.**

!

Помимо заблокированного порта, единственным активным портом на этом коммутаторе является порт, выделенный в качестве порта корневого моста. Уменьшите стоимость этого порта корневого моста до 18, выполнив команду spanning-tree vlan 1 cost 18 режима конфигурации интерфейса

Коммутатор s2 

enable

conf t

int e0/1

spanning-tree vlan 1 cost 18




**Почему протокол spanning-tree заменяет ранее заблокированный порт на назначенный порт и блокирует порт, который был назначенным портом на другом коммутаторе?**

Когда какой нибудь из путей становится неактивным\недоступным, протокол SPT пересчитывает топологию и позволяет альтернативному пути стать назначенным, таким образом предостращается возниконовение петель.

**Шаг 4:	Удалите изменения стоимости порта.**

S2  enable

conf t

int e0/1

no spanning-tree vlan 1 cost 18






**Часть 4:	Наблюдение за процессом выбора протоколом STP порта, исходя из приоритета портов**

a.	Включите порты e0/0 и e0/2 на всех коммутаторах.
b.	Подождите 30 секунд, чтобы протокол STP завершил процесс перевода порта, после чего выполните команду show spanning-tree на коммутаторах некорневого моста. Обратите внимание, что порт корневого моста переместился на порт с меньшим номером, связанный с коммутатором корневого моста, и заблокировал предыдущий порт корневого моста.

!
s1, s2, s3

conf t

int range e0/0, e0/2
no shutdown

do show spanning-tree

![alt text](image-4.png)

**Какой порт выбран протоколом STP в качестве порта корневого моста на каждом коммутаторе некорневого моста?**

s2 - port e0/0
s3 - port e0/2

**Почему протокол STP выбрал эти порты в качестве портов корневого моста на этих коммутаторах?**

Если стоимость равна, то далее для определения корневого моста используется приоритет портов


**1.Какое значение протокол STP использует первым после выбора корневого моста, чтобы определить выбор порта?**

Первым критерием, используемым в процессе выбора корневого порта, является наименьшая стоимость пути к корневому мосту

**2.Если первое значение на двух портах одинаково, какое следующее значение будет использовать протокол STP при выборе порта?**

Если первое значение на двух портах одинаково, сравнивает BID


**3.Если оба значения на двух портах равны, каким будет следующее значение, которое использует протокол STP при выборе порта?**

Если оба значения на двух портах равны, используются приоритеты портов





